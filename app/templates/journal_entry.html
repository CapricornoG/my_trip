{% extends "base.html" %}

{% block content %}
    <div class="content-section">
        <h1 class="h3 mb-3 font-weight-normal">{{ journal_entry.title }}</h1>
        <p>Posted by {{ journal_entry.author.username if journal_entry.author else 'Unknown' }} on {{ journal_entry.date_posted.strftime('%Y-%m-%d') }}</p>
        <hr>

        <!-- Display the image if one exists -->
        {% if journal_entry.image_file %}
            <img src="{{ url_for('static', filename='images/' ~ journal_entry.image_file) }}" alt="{{ journal_entry.title }}" class="img-fluid mb-3">
        {% endif %}

        <p>{{ journal_entry.content }}</p>

        {% if current_user.is_authenticated %}
            <div class="d-flex justify-content-between">
                <a href="{{ url_for('main.journal_entries') }}" class="btn btn-secondary">Back to My Entries</a>
                
                <!-- Edit and Delete buttons (only for the author) -->
                {% if journal_entry.author == current_user %}
                    <div>
                        <a href="{{ url_for('main.edit_journal_entry', entry_id=journal_entry.id) }}" class="btn btn-sm btn-secondary">Edit</a>
                        <form method="POST" action="{{ url_for('main.delete_journal_entry', entry_id=journal_entry.id) }}" style="display: inline;">
                            {{ form.hidden_tag() }}
                            <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this entry?');">Delete</button>
                        </form>
                    </div>
                {% endif %}
            </div>
        {% else %}
            <a href="{{ url_for('main.home') }}" class="btn btn-primary">Go to Home</a>
            <a href="#" data-toggle="modal" data-target="#loginModal" class="btn btn-secondary" role="button" aria-controls="loginModal">Login</a>
            <a href="#" data-toggle="modal" data-target="#registerModal" class="btn btn-secondary" role="button" aria-controls="registerModal">Register</a>
        {% endif %}
    </div>
{% endblock %}
